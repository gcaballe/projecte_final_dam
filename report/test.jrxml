<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="test" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="24c91959-d8e2-44a8-a305-fe42ba8c15ca">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="param_id_categoria" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
	r.id as r_id,
	r.titol as r_titol,
	r.descMarkDown as r_descMarkDown,
	r.desnivell as r_desnivell,
	r.alcadaMax as r_alcadaMax,
	r.alcadaMin as r_alcadaMin,
	r.distanciaKm as r_distanciaKm,
	r.tempsAprox as r_tempsAprox,
	r.circular as r_circular,
	r.dificultat5 as r_dificultat5,
	r.foto as r_foto,

	count(p.numero) as count_punts,

	p.numero as p_numero,
	p.nom as p_nom,
	p.descripcio as p_descripcio,
	p.hora as p_hora,
	p.latitud as p_latitud,
	p.longitud as p_longitud,
	p.elevacio as p_elevacio,
	p.foto as p_foto,

	c.nom as c_nom

FROM ruta r
left JOIN punt p on (r.id = p.ruta)
JOIN categoria c on (r.categoria = c.id)


WHERE c.id = $P{param_id_categoria}


order by r.id]]>
	</queryString>
	<field name="r_id" class="java.lang.Integer"/>
	<field name="r_titol" class="java.lang.String"/>
	<field name="r_descMarkDown" class="java.lang.String"/>
	<field name="r_desnivell" class="java.lang.Integer"/>
	<field name="r_alcadaMax" class="java.lang.Integer"/>
	<field name="r_alcadaMin" class="java.lang.Integer"/>
	<field name="r_distanciaKm" class="java.lang.Integer"/>
	<field name="r_tempsAprox" class="java.lang.Integer"/>
	<field name="r_circular" class="java.lang.Boolean"/>
	<field name="r_dificultat5" class="java.lang.Integer"/>
	<field name="r_foto" class="java.lang.String"/>
	<field name="count_punts" class="java.lang.Long"/>
	<field name="p_numero" class="java.lang.Integer"/>
	<field name="p_nom" class="java.lang.String"/>
	<field name="p_descripcio" class="java.lang.String"/>
	<field name="p_hora" class="java.lang.Integer"/>
	<field name="p_latitud" class="java.lang.Double"/>
	<field name="p_longitud" class="java.lang.Double"/>
	<field name="p_elevacio" class="java.lang.Integer"/>
	<field name="p_foto" class="java.lang.String"/>
	<field name="c_nom" class="java.lang.String"/>
	<group name="grup">
		<groupExpression><![CDATA[$F{r_id}]]></groupExpression>
		<groupHeader>
			<band height="119">
				<staticText>
					<reportElement x="61" y="89" width="100" height="20" uuid="9185c776-935f-4649-b351-8dce858b3b28"/>
					<text><![CDATA[GRUP HEADER ATT 1]]></text>
				</staticText>
				<staticText>
					<reportElement x="289" y="89" width="100" height="20" uuid="e6be1049-a6bf-4ad3-8322-a0c99ae736e2"/>
					<text><![CDATA[GRUP HEADER ATT 2]]></text>
				</staticText>
				<textField>
					<reportElement x="61" y="58" width="100" height="20" uuid="dcd5bb84-4d46-460e-a081-a8ac5397dd70"/>
					<textFieldExpression><![CDATA[$F{r_id}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="62" y="36" width="100" height="20" uuid="860702b1-4ae4-401d-b7b6-6bf4f88abfd1"/>
					<text><![CDATA[p_numero]]></text>
				</staticText>
				<staticText>
					<reportElement x="306" y="36" width="100" height="20" uuid="400ee221-f29e-404e-a886-309396d35e6b"/>
					<text><![CDATA[p_nom]]></text>
				</staticText>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="35" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="61" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="125" splitType="Stretch">
			<textField>
				<reportElement x="63" y="48" width="100" height="20" uuid="17458c87-74d6-4d08-941b-580074f3dd08"/>
				<textFieldExpression><![CDATA[$F{p_numero}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="307" y="58" width="100" height="20" uuid="058fece4-3c07-4cba-935d-a9312a109f0a"/>
				<textFieldExpression><![CDATA[$F{p_nom}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="45" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="54" splitType="Stretch"/>
	</pageFooter>
</jasperReport>
